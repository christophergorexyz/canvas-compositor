{"version":3,"sources":["../src/PrimitiveComponent.js"],"names":["defaults","fillStyle","Defaults","FILL_STYLE","strokeStyle","STROKE_STYLE","lineCap","LINE_CAP","lineWidth","LINE_WIDTH","lineJoin","LINE_JOIN","miterLimit","MITER_LIMIT","font","FONT","textAlign","TEXT_ALIGN","textBaseline","TEXT_BASELINE","lineDash","PrimitiveComponent","options","_needsDraw","_needsRender","_scaleWidth","_scaleHeight","_d","Vector","x","y","style","Object","assign","_prerenderingCanvas","document","createElement","_prerenderingContext","getContext","_parent","parent","context","offset","boundingBox","needsDraw","needsRender","render","width","right","left","height","bottom","top","pointIsInBoundingBox","index","children","indexOf","splice","length","UpdateChildrenLists","add","d","val","c","scaleWidth","scaleHeight","compoundScale","EventEmitter"],"mappings":"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","sourcesContent":["import {\r\n    Vector\r\n} from 'vectorious';\r\n\r\nimport {\r\n    drawImage,\r\n    clearRect\r\n} from './Renderer';\r\n\r\nimport {\r\n    EventEmitter\r\n} from 'micro-mvc';\r\n\r\nimport * as Defaults from './Defaults';\r\n\r\n//assign default values to an object so that the Object.assign function can be used\r\n/**\r\n * The default values to be passed to the renderer and overridden by any given object\r\n */\r\nlet defaults = {\r\n    //direction: 'inherit',\r\n    fillStyle: Defaults.FILL_STYLE,\r\n    //filter: 'none',\r\n    strokeStyle: Defaults.STROKE_STYLE,\r\n    lineCap: Defaults.LINE_CAP,\r\n    lineWidth: Defaults.LINE_WIDTH,\r\n    lineJoin: Defaults.LINE_JOIN,\r\n    miterLimit: Defaults.MITER_LIMIT,\r\n    font: Defaults.FONT,\r\n    textAlign: Defaults.TEXT_ALIGN,\r\n    textBaseline: Defaults.TEXT_BASELINE,\r\n    lineDash: []\r\n};\r\n\r\n/**\r\n * The base class of things that may be drawn on the canvas.\r\n * All drawable objects should inherit from this class.\r\n * Typically, it is unnecessary for application programmers to\r\n * call this directly, although they may wish to extend their own\r\n * classes with it.\r\n */\r\nexport class PrimitiveComponent extends EventEmitter {\r\n    /**\r\n     * construct a primitive component\r\n     * @param {object} options\r\n     */\r\n    constructor(options) {\r\n        super();\r\n\r\n        options = options || {};\r\n\r\n        //TODO: reimplement any flags for debug data\r\n        //this._flags = {};\r\n        //this._flags.DEBUG = options.debug || false;\r\n\r\n        /**\r\n         * does the object need to be redrawn?\r\n         * @type {boolean} _needsDraw\r\n         */\r\n        this._needsDraw = true;\r\n\r\n        /**\r\n         * does the object need to be rendered?\r\n         * @type {boolean} _needsRender\r\n         */\r\n        this._needsRender = true;\r\n\r\n        /**\r\n         * the horizontal scale of the object. defaults to 1\r\n         * @type {number} _scaleWidth\r\n         */\r\n        this._scaleWidth = 1;\r\n\r\n        /**\r\n         * the vertical scale of the object. defaults to 1\r\n         * @type {number} _scaleHeight\r\n         */\r\n        this._scaleHeight = 1;\r\n\r\n        /**\r\n         * d is for \"displacement\": a 2D Vector object representing cartesian coordinate\r\n         * position relative to its parent composition (or [0,0] if this is the scene composition)\r\n         * @type {object} d\r\n         */\r\n        this._d = new Vector([options.x || 0, options.y || 0]);\r\n\r\n        /**\r\n         * style options for this particular object. these are standard context styles\r\n         * @type {object} style\r\n         */\r\n        this.style = Object.assign({}, defaults, options.style);\r\n\r\n        //TODO: determine whether this is the best place to implement click passthrough -\r\n        //it might be better left implemented by consuming modules\r\n        /**\r\n         * objects with pressPassThrough set to true will allow mouse clicks to pass\r\n         * through to objects behind them\r\n         * @type {boolean} pressPassThrough\r\n         */\r\n        //this.pressPassThrough = options.pressPassThrough || false;\r\n\r\n        /**\r\n         * the prerendering canvas is used to avoid performing mutliple draw operations on the\r\n         * visible, main canvas. this minimizes the time needed to render by prerendering on a\r\n         * canvas only as large as necessary for the object\r\n         * @type {object} _prerenderingCanvas\r\n         */\r\n        this._prerenderingCanvas = document.createElement('canvas');\r\n\r\n        //TODO: enable alternative rendering contexts for WebGL and 3d\r\n        /**\r\n         * the 2D context of the prerendering canvas.\r\n         * @type {object} _prerenderingCanvas\r\n         */\r\n        this._prerenderingContext = this._prerenderingCanvas.getContext('2d');\r\n\r\n        /**\r\n         * the parent object of this object. with the exception of the scene composition itself,\r\n         * the root of all objects ancestry should be the scene composition\r\n         * @type {object} parent\r\n         */\r\n        this._parent = options.parent || null;\r\n    }\r\n\r\n    /**\r\n     * the global offset of the object on the canvas.\r\n     * this is the sum of this object's displacement\r\n     * and all of its ancestry.\r\n     * @type {object} offset a 2D Vector representing displacement from [0, 0]\r\n     */\r\n    get offset() {\r\n        return (this.parent ? Vector.add(this.d, this.parent.offset) : this.d);\r\n    }\r\n\r\n    /**\r\n     * returns true whenever the object needs to be re-drawn to canvas.\r\n     * when true, this will indicate to the parent tree of composing objects that\r\n     * the object needs to be re-drawn on the next animation loop.\r\n     *\r\n     * objects need to be updated when their displacement changes, or when any thing\r\n     * that requires a rerender occurs.\r\n     *\r\n     * @type {boolean} needsDraw\r\n     */\r\n    get needsDraw() {\r\n        return this._needsDraw;\r\n    }\r\n\r\n    /**\r\n     * set to true whenever the object needs to be re-drawn to canvas.\r\n     * when true, this will indicate to the parent tree of composing objects that\r\n     * the object needs to be re-drawn on the next animation loop.\r\n     *\r\n     * objects need to be updated when their displacement changes, or when any thing\r\n     * that requires a rerender occurs.\r\n     *\r\n     * @type {boolean} needsDraw\r\n     */\r\n    set needsDraw(val) {\r\n        if (this.parent && val) {\r\n            this.parent.needsDraw = val;\r\n            this.parent.needsRender = true; // if this needs to be redrawn, then the parent needs a full rerender\r\n        }\r\n        this._needsDraw = val;\r\n    }\r\n\r\n    /**\r\n     * returns true whenever the object's properties have changed such that\r\n     * it needs to be rendered differently\r\n     *\r\n     * 1. scale change\r\n     * 1. physical property change (height, width, radius, etc.)\r\n     * 1. color change\r\n     *\r\n     * @type {boolean} needsRender\r\n     */\r\n    get needsRender() {\r\n        return this._needsRender;\r\n    }\r\n\r\n    /**\r\n     * set to true whenever the object's properties have changed such that\r\n     * it needs to be rendered differently\r\n     *\r\n     * 1. scale change\r\n     * 1. physical property change (height, width, radius, etc.)\r\n     * 1. color change\r\n     *\r\n     * @type {boolean} needsRender\r\n     */\r\n    set needsRender(val) {\r\n        if (this.parent && val) {\r\n            this.parent.needsRender = val;\r\n        }\r\n        this._needsRender = val;\r\n    }\r\n\r\n    /**\r\n     * return the horizontal scale of the object - defaults to 1\r\n     * @type {number} scaleWidth\r\n     */\r\n    get scaleWidth() {\r\n        return this._scaleWidth;\r\n    }\r\n    /**\r\n     * set the horizontal scale of the object - defaults to 1\r\n     * @type {number} scaleWidth\r\n     */\r\n    set scaleWidth(val) {\r\n        this._scaleWidth = val;\r\n        this.needsRender = true;\r\n        this.needsDraw = true;\r\n        for (let c of this.children) {\r\n            c.needsRender = true;\r\n            c.needsDraw = true;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * return the vertical scale of the object - defaults to 1\r\n     * @type {number} scaleHeight\r\n     */\r\n    get scaleHeight() {\r\n        return this._scaleHeight;\r\n    }\r\n\r\n    /**\r\n     * set the vertical scale of the object - defaults to 1\r\n     * @type {number} scaleHeight\r\n     * @param {number} val the vertical scale\r\n     */\r\n    set scaleHeight(val) {\r\n        this._scaleHeight = val;\r\n        this.needsRender = true;\r\n        this.needsDraw = true;\r\n        for (let c of this.children) {\r\n            c.needsRender = true;\r\n            c.needsDraw = true;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * return an object containing the vertical and horizontal scale\r\n     * @type {object} scale\r\n     */\r\n    get scale() {\r\n        return {\r\n            scaleWidth: this.scaleWidth,\r\n            scaleHeight: this.scaleHeight\r\n        };\r\n    }\r\n\r\n    /**\r\n     * set the scale width and height in one go\r\n     * @type {number} scale\r\n     */\r\n    set scale(val) {\r\n        this.scaleHeight = val;\r\n        this.scaleWidth = val;\r\n    }\r\n\r\n    /**\r\n     * return the scale of the object, compounded with the parent object's scale\r\n     * @type {{scaleWidth: number, scaleHeight: number}} compoundScale the scale multiplied by the compound scale of its parent or 1\r\n     */\r\n    get compoundScale() {\r\n        return {\r\n            scaleWidth: this.parent ? this.scaleWidth * this.parent.compoundScale.scaleWidth : this.scaleWidth,\r\n            scaleHeight: this.parent ? this.scaleHeight * this.parent.compoundScale.scaleHeight : this.scaleHeight\r\n        };\r\n    }\r\n\r\n    /**\r\n     * d is for displacement - returns a vector\r\n     * @type {object} d\r\n     */\r\n    get d() {\r\n        return this._d;\r\n    }\r\n\r\n    /**\r\n     * d is for displacement - accepts a vector\r\n     * @type {object} d\r\n     * @param {object} val a vector\r\n     */\r\n    set d(val) {\r\n        this._d = val;\r\n    }\r\n\r\n    /**\r\n     * get the parent of the object. all objects except the scene graph should have a parent\r\n     * @type {object} parent\r\n     */\r\n    get parent() {\r\n        return this._parent;\r\n    }\r\n    //TODO: provide links to things\r\n    /**\r\n     * set the parent of the object. all objects except the scene graph should have a parent\r\n     * @type {object} parent\r\n     * @param {object} val a composition\r\n     */\r\n    set parent(val) {\r\n        this._parent = val;\r\n    }\r\n\r\n    /**\r\n     * draw the object to canvas, render it if necessary\r\n     * @param {object} context the final canvas context where this will be drawn\r\n     * @param {object} offset the offset on the canvas - optional, used for prerendering\r\n     */\r\n    draw(context, offset) {\r\n        let boundingBox = this.boundingBox;\r\n\r\n        this.needsDraw = false;\r\n\r\n        if (this.needsRender && this.render) {\r\n            /*\r\n                TODO: AB-test this,\r\n                it may be faster than clearRect\r\n            */\r\n            //delete this._prerenderingCanvas;\r\n            //delete this._prerenderingContext;\r\n\r\n            //create a new canvas and context for rendering\r\n            //this._prerenderingCanvas = document.createElement('canvas');\r\n            //this._prerenderingContext = this._prerenderingCanvas.getContext('2d'); //text needs prerendering context defined for boundingBox measurements\r\n\r\n            //make sure the new canvas has the appropriate dimensions\r\n            this._prerenderingCanvas.width = boundingBox.right - boundingBox.left;\r\n            this._prerenderingCanvas.height = boundingBox.bottom - boundingBox.top;\r\n            //clear any old rendering artifacts - they are no longer viable\r\n            clearRect(0, 0, this._prerenderingCanvas.width, this._prerenderingCanvas.height, this._prerenderingContext);\r\n\r\n            this.render();\r\n            this.needsRender = false;\r\n        }\r\n\r\n        //TODO: handle debug options\r\n        //draw bounding boxes\r\n        /*if (this._flags.DEBUG) {\r\n            this._prerenderingContext.beginPath();\r\n            this._prerenderingContext.setLineDash([5, 15]);\r\n            this._prerenderingContext.lineWidth = 2.0;\r\n            this._prerenderingContext.strokeStyle = '#FF0000';\r\n            this._prerenderingContext.strokeStyle = '#FF0000';\r\n            this._prerenderingContext.strokeRect(0, 0, this._prerenderingCanvas.width, this._prerenderingCanvas.height);\r\n            this._prerenderingContext.closePath();\r\n        }*/\r\n\r\n        //offsets are for prerendering contexts of compositions\r\n        let x = boundingBox.left + (offset && offset.left ? offset.left : 0);\r\n        let y = boundingBox.top + (offset && offset.top ? offset.top : 0);\r\n        drawImage(x, y, this._prerenderingCanvas, context, this.style);\r\n    }\r\n\r\n    /**\r\n     * this method must be overridden by a subclass.\r\n     *\r\n     * the render method should be implemented by subclasses\r\n     * @abstract\r\n     */\r\n    render() {}\r\n\r\n    /**\r\n     * check whether the point specified lies *inside* this objects bounding box\r\n     *\r\n     * @param {number} x the x coordinate\r\n     * @param {number} y the y coordinate\r\n     * @return {boolean} whether the point is within the bounding box\r\n     */\r\n    pointIsInBoundingBox(x, y) {\r\n        let boundingBox = this.boundingBox;\r\n        return (\r\n            x > boundingBox.left &&\r\n            y > boundingBox.top &&\r\n            x < boundingBox.right &&\r\n            y < boundingBox.bottom\r\n        );\r\n    }\r\n\r\n    /**\r\n     * check whether the point is within the object.\r\n     * this method should be overridden by subclassess\r\n     *\r\n     * @param {number} x the x coordinate\r\n     * @param {number} y the y coordinate\r\n     * @return {boolean} whether the point is in the object, as implemented by inheriting classes\r\n     */\r\n    pointIsInObject(x, y) {\r\n        return this.pointIsInBoundingBox(x, y);\r\n    }\r\n\r\n    /**\r\n     * move the object on top of other objects (render last)\r\n     */\r\n    moveToFront() {\r\n        if (this.parent) {\r\n            let index = this.parent.children.indexOf(this);\r\n            if (index >= 0) {\r\n                this.parent.children.splice(index, 1);\r\n                this.parent.children.splice(this.parent.children.length, 0, this);\r\n                this.needsDraw = true;\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * move the object below the other objects (render first)\r\n     */\r\n    moveToBack() {\r\n        if (this.parent) {\r\n            let index = this.parent.children.indexOf(this);\r\n            if (index >= 0) {\r\n                this.parent.children.splice(index, 1);\r\n                this.parent.children.splice(0, 0, this);\r\n                this.needsDraw = true;\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * move the object forward in the stack (drawn later)\r\n     */\r\n    moveForward() {\r\n        if (this.parent) {\r\n            let index = this.parent.children.indexOf(this);\r\n            if (index >= 0 && index < this.parent.children.length - 1) {\r\n                this.parent.children.splice(index, 1);\r\n                this.parent.children.splice(index + 1, 0, this); //if index + 1 > siblings.length, inserts it at end\r\n                this.parent.UpdateChildrenLists();\r\n                this.needsRender = true;\r\n                this.needsDraw = true;\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * move the object backward in the stack (drawn sooner)\r\n     */\r\n    moveBackward() {\r\n        if (this.parent) {\r\n            let index = this.parent.children.indexOf(this);\r\n            if (index > 0) {\r\n                this.parent.children.splice(index, 1);\r\n                this.parent.children.splice(index - 1, 0, this);\r\n                this.parent.UpdateChildrenLists();\r\n                this.needsRender = true;\r\n                this.needsDraw = true;\r\n            }\r\n        }\r\n    }\r\n}\r\n"],"file":"PrimitiveComponent.js"}