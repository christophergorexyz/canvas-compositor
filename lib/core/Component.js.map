{"version":3,"sources":["../../src/core/Component.js"],"names":["defaults","fillStyle","Defaults","FILL_STYLE","strokeStyle","STROKE_STYLE","lineCap","LINE_CAP","lineWidth","LINE_WIDTH","lineJoin","LINE_JOIN","miterLimit","MITER_LIMIT","font","FONT","textAlign","TEXT_ALIGN","textBaseline","TEXT_BASELINE","lineDash","Component","options","needsDraw","needsRender","d","Vector","x","y","_scaleWidth","_scaleHeight","style","Object","assign","_parent","parent","_prerenderingCanvas","document","createElement","_prerenderingContext","prerenderingCanvas","getContext","add","offset","_needsDraw","val","_needsRender","children","c","scaleWidth","scaleHeight","compoundScale","_d","_boundingBox","context","boundingBox","width","right","left","height","bottom","top","prerenderingContext","render","pointIsInBoundingBox","index","indexOf","splice","length","UpdateChildrenLists","EventEmitter"],"mappings":"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","sourcesContent":["import { Vector } from 'vectorious';\nimport EventEmitter from '../events/EventEmitter';\nimport * as Defaults from './Defaults';\nimport { drawImage, clearRect } from '../graphics/Renderer';\n\n\n//assign default values to an object so that the Object.assign function can be used\n/**\n * The default values to be passed to the renderer and overridden by any given object\n */\nlet defaults = {\n  //direction: 'inherit',\n  fillStyle: Defaults.FILL_STYLE,\n  //filter: 'none',\n  strokeStyle: Defaults.STROKE_STYLE,\n  lineCap: Defaults.LINE_CAP,\n  lineWidth: Defaults.LINE_WIDTH,\n  lineJoin: Defaults.LINE_JOIN,\n  miterLimit: Defaults.MITER_LIMIT,\n  font: Defaults.FONT,\n  textAlign: Defaults.TEXT_ALIGN,\n  textBaseline: Defaults.TEXT_BASELINE,\n  lineDash: []\n};\n\n/**\n * The base class of things that may be drawn on the canvas.\n * All drawable objects should inherit from this class.\n * Typically, it is unnecessary for application programmers to\n * call this directly, although they may wish to extend their own\n * classes with it.\n */\nexport default class Component extends EventEmitter {\n  //TODO: provide details about options for docs - link to a separate page\n  /**\n   * construct a primitive component\n   * @param {object} options\n   */\n  constructor(options = {}) {\n    super();\n\n    //TODO: reimplement any flags for debug data\n    //this._flags = {};\n    //this._flags.DEBUG = options.debug || false;\n\n    this.needsDraw = true;\n    this.needsRender = true;\n    this.d = new Vector([options.x || 0, options.y || 0]);\n\n    /**\n     * the horizontal scale of the object. defaults to 1\n     * @type {number} _scaleWidth\n     */\n    this._scaleWidth = 1;\n\n    /**\n     * the vertical scale of the object. defaults to 1\n     * @type {number} _scaleHeight\n     */\n    this._scaleHeight = 1;\n\n\n    /**\n     * style options for this particular object. these are standard context styles\n     * @type {object} style\n     */\n    this.style = Object.assign({}, defaults, options.style);\n\n    /**\n     * the parent object of this object. with the exception of the scene composition itself,\n     * the root of all objects ancestry should be the scene composition\n     * @type {object} parent\n     */\n    this._parent = options.parent || null;\n  }\n\n  /**\n   * the prerendering canvas is used to avoid performing mutliple draw operations on the\n   * visible, main canvas. this minimizes the time needed to render by prerendering on a\n   * canvas only as large as necessary for the object\n   * @type {object} _prerenderingCanvas\n   */\n  get prerenderingCanvas() {\n    return this._prerenderingCanvas || (this._prerenderingCanvas = document.createElement('canvas'));\n  }\n\n  //TODO: enable alternative rendering contexts for WebGL and 3d\n  /**\n   * the 2D context of the prerendering canvas.\n   * @type {object} _prerenderingCanvas\n   */\n  get prerenderingContext() {\n    return this._prerenderingContext || (this._prerenderingContext = this.prerenderingCanvas.getContext('2d'));\n  }\n\n  /**\n   * the global offset of the object on the canvas.\n   * this is the sum of this object's displacement\n   * and all of its ancestry.\n   * @type {object} offset a 2D Vector representing displacement from [0, 0]\n   */\n  get offset() {\n    return (this.parent ? Vector.add(this.d, this.parent.offset) : this.d);\n  }\n\n  /**\n   * returns true whenever the object needs to be re-drawn to canvas.\n   * when true, this will indicate to the parent tree of composing objects that\n   * the object needs to be re-drawn on the next animation loop.\n   *\n   * objects need to be updated when their displacement changes, or when any thing\n   * that requires a rerender occurs.\n   *\n   * @type {boolean} needsDraw\n   */\n  get needsDraw() {\n    return this._needsDraw;\n  }\n\n  /**\n   * set to true whenever the object needs to be re-drawn to canvas.\n   * when true, this will indicate to the parent tree of composing objects that\n   * the object needs to be re-drawn on the next animation loop.\n   *\n   * objects need to be updated when their displacement changes, or when any thing\n   * that requires a rerender occurs.\n   *\n   * @type {boolean} needsDraw\n   */\n  set needsDraw(val) {\n    //TODO: this could probably be handled better,\n    //possibly by using events to direct animation to\n    //draw specific components\n    if (this.parent && val) {\n      this.parent.needsDraw = val;\n      this.parent.needsRender = true; // if this needs to be redrawn, then the parent needs a full rerender\n    }\n    this._needsDraw = val;\n  }\n\n  /**\n   * returns true whenever the object's properties have changed such that\n   * it needs to be rendered differently\n   *\n   * 1. scale change\n   * 1. physical property change (height, width, radius, etc.)\n   * 1. color change\n   *\n   * @type {boolean} needsRender\n   */\n  get needsRender() {\n    return this._needsRender;\n  }\n\n  /**\n   * set to true whenever the object's properties have changed such that\n   * it needs to be rendered differently\n   *\n   * 1. scale change\n   * 1. physical property change (height, width, radius, etc.)\n   * 1. color change\n   *\n   * @type {boolean} needsRender\n   */\n  set needsRender(val) {\n    if (this.parent && val) {\n      this.parent.needsRender = val;\n    }\n    this._needsRender = val;\n  }\n\n  /**\n   * return the horizontal scale of the object - defaults to 1\n   * @type {number} scaleWidth\n   */\n  get scaleWidth() {\n    return this._scaleWidth;\n  }\n\n  /**\n   * set the horizontal scale of the object - defaults to 1\n   * @type {number} scaleWidth\n   */\n  set scaleWidth(val) {\n    this._scaleWidth = val;\n    this.needsRender = true;\n    this.needsDraw = true;\n    for (let c of this.children) {\n      c.needsRender = true;\n      c.needsDraw = true;\n    }\n  }\n\n  /**\n   * return the vertical scale of the object - defaults to 1\n   * @type {number} scaleHeight\n   */\n  get scaleHeight() {\n    return this._scaleHeight;\n  }\n\n  /**\n   * set the vertical scale of the object - defaults to 1\n   * @type {number} scaleHeight\n   * @param {number} val the vertical scale\n   */\n  set scaleHeight(val) {\n    this._scaleHeight = val;\n    this.needsRender = true;\n    this.needsDraw = true;\n    for (let c of this.children) {\n      c.needsRender = true;\n      c.needsDraw = true;\n    }\n  }\n\n  /**\n   * return an object containing the vertical and horizontal scale\n   * @type {object} scale\n   */\n  get scale() {\n    return {\n      scaleWidth: this.scaleWidth,\n      scaleHeight: this.scaleHeight\n    };\n  }\n\n  /**\n   * set the scale width and height in one go\n   * @type {number} scale\n   */\n  set scale(val) {\n    this.scaleHeight = val;\n    this.scaleWidth = val;\n  }\n\n  /**\n   * return the scale of the object, compounded with the parent object's scale\n   * @type {{scaleWidth: number, scaleHeight: number}} compoundScale the scale multiplied by the compound scale of its parent or 1\n   */\n  get compoundScale() {\n    return {\n      scaleWidth: this.parent ? this.scaleWidth * this.parent.compoundScale.scaleWidth : this.scaleWidth,\n      scaleHeight: this.parent ? this.scaleHeight * this.parent.compoundScale.scaleHeight : this.scaleHeight\n    };\n  }\n\n  /**\n   * d is for displacement - returns a vector\n   * @type {object} d\n   */\n  get d() {\n    return this._d;\n  }\n\n  /**\n   * d is for displacement - accepts a vector\n   * @type {object} d\n   * @param {object} val a vector\n   */\n  set d(val) {\n    this._d = val;\n  }\n\n  /**\n   * get the parent of the object. all objects except the scene graph should have a parent\n   * @type {object} parent\n   */\n  get parent() {\n    return this._parent;\n  }\n\n  /**\n   * set the parent of the object. all objects except the scene graph should have a parent\n   * see https://en.wikipedia.org/wiki/Composite_pattern\n   * @type {object} parent\n   * @param {object} val a composition\n   */\n  set parent(val) {\n    this._parent = val;\n  }\n\n  set boundingBox(val) {\n    this._boundingBox = val;\n  }\n\n  /**\n   * draw the object to canvas, render it if necessary\n   * @param {object} context the final canvas context where this will be drawn\n   * @param {object} offset the offset on the canvas - optional, used for prerendering\n   */\n  draw(context, offset) {\n    let boundingBox = this.boundingBox;\n\n    this.needsDraw = false;\n\n    if (this.needsRender) {\n      /*\n          TODO: AB-test this,\n          it may be faster than clearRect\n      */\n      //delete this._prerenderingCanvas;\n      //delete this._prerenderingContext;\n\n      //make sure the new canvas has the appropriate dimensions\n      this.prerenderingCanvas.width = boundingBox.right - boundingBox.left;\n      this.prerenderingCanvas.height = boundingBox.bottom - boundingBox.top;\n      //clear any old rendering artifacts - they are no longer viable\n      clearRect(0, 0, this.prerenderingCanvas.width, this.prerenderingCanvas.height, this.prerenderingContext);\n\n      this.render();\n      this.needsRender = false;\n    }\n\n    //TODO: handle debug options\n    //draw bounding boxes\n    /*if (this._flags.DEBUG) {\n        this.prerenderingContext.beginPath();\n        this.prerenderingContext.setLineDash([5, 15]);\n        this.prerenderingContext.lineWidth = 2.0;\n        this.prerenderingContext.strokeStyle = '#FF0000';\n        this.prerenderingContext.strokeStyle = '#FF0000';\n        this.prerenderingContext.strokeRect(0, 0, this.prerenderingCanvas.width, this.prerenderingCanvas.height);\n        this.prerenderingContext.closePath();\n    }*/\n\n    //offsets are for prerendering contexts of compositions\n    let x = boundingBox.left + (offset && offset.left ? offset.left : 0);\n    let y = boundingBox.top + (offset && offset.top ? offset.top : 0);\n    drawImage(x, y, this.prerenderingCanvas, context, this.style);\n  }\n\n  /**\n   * this method must be overridden by a subclass.\n   *\n   * the render method should be implemented by subclasses\n   * @abstract\n   */\n  render() { }\n\n  /**\n   * check whether the point specified lies *inside* this objects bounding box\n   *\n   * @param {number} x the x coordinate\n   * @param {number} y the y coordinate\n   * @return {boolean} whether the point is within the bounding box\n   */\n  pointIsInBoundingBox(x, y) {\n    let boundingBox = this.boundingBox;\n    return (\n      x > boundingBox.left &&\n      y > boundingBox.top &&\n      x < boundingBox.right &&\n      y < boundingBox.bottom\n    );\n  }\n\n  /**\n   * check whether the point is within the object.\n   * this method should be overridden by subclassess\n   *\n   * @param {number} x the x coordinate\n   * @param {number} y the y coordinate\n   * @return {boolean} whether the point is in the object, as implemented by inheriting classes\n   */\n  pointIsInObject(x, y) {\n    return this.pointIsInBoundingBox(x, y);\n  }\n\n  /**\n   * move the object on top of other objects (render last)\n   */\n  moveToFront() {\n    if (this.parent) {\n      let index = this.parent.children.indexOf(this);\n      if (index >= 0) {\n        this.parent.children.splice(index, 1);\n        this.parent.children.splice(this.parent.children.length, 0, this);\n        this.needsDraw = true;\n      }\n    }\n  }\n\n  /**\n   * move the object below the other objects (render first)\n   */\n  moveToBack() {\n    if (this.parent) {\n      let index = this.parent.children.indexOf(this);\n      if (index >= 0) {\n        this.parent.children.splice(index, 1);\n        this.parent.children.splice(0, 0, this);\n        this.needsDraw = true;\n      }\n    }\n  }\n\n\n  /**\n   * move the object forward in the stack (drawn later)\n   */\n  moveForward() {\n    if (this.parent) {\n      let index = this.parent.children.indexOf(this);\n      if (index >= 0 && index < this.parent.children.length - 1) {\n        this.parent.children.splice(index, 1);\n        this.parent.children.splice(index + 1, 0, this); //if index + 1 > siblings.length, inserts it at end\n        this.parent.UpdateChildrenLists();\n        this.needsRender = true;\n        this.needsDraw = true;\n      }\n    }\n  }\n\n  /**\n   * move the object backward in the stack (drawn sooner)\n   */\n  moveBackward() {\n    if (this.parent) {\n      let index = this.parent.children.indexOf(this);\n      if (index > 0) {\n        this.parent.children.splice(index, 1);\n        this.parent.children.splice(index - 1, 0, this);\n        this.parent.UpdateChildrenLists();\n        this.needsRender = true;\n        this.needsDraw = true;\n      }\n    }\n  }\n}\n"],"file":"Component.js"}