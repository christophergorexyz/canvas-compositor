{"version":3,"sources":["../src/Text.js"],"names":["Text","options","text","fontSize","TextDefaults","FONT_SIZE","fontFamily","fontStyle","FONT_STYLE","fontVariant","FONT_VARIANT","fontWeight","FONT_WEIGHT","lineHeight","LINE_HEIGHT","textAlign","TEXT_ALIGN","textBaseline","TEXT_BASELINE","_textMetricsNeedUpdate","_textMetrics","Object","assign","style","font","fontString","_updateStyle","textMetrics","ascent","_prerenderingContext","TextUtils","formatFontString","measureText","getTextHeight","top","offset","y","left","x","bottom","descent","right","width","PrimitiveComponent"],"mappings":"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","sourcesContent":["import {\r\n    drawText\r\n} from './Renderer';\r\nimport {\r\n    PrimitiveComponent\r\n} from './PrimitiveComponent';\r\n\r\nimport * as TextUtils from './TextUtilities';\r\n\r\nimport * as TextDefaults from './TextDefaults';\r\n\r\n/**\r\n * A text object\r\n */\r\nexport class Text extends PrimitiveComponent {\r\n    /**\r\n     * @param {object} options the options for the text object\r\n     */\r\n    constructor(options) {\r\n        super(options);\r\n\r\n        /**\r\n         * the text to be rendered\r\n         * @type {string}\r\n         */\r\n        this.text = options.text;\r\n\r\n        /**\r\n         * the font size at which to render the text\r\n         * @type {string}\r\n         */\r\n        this.fontSize = options.fontSize || TextDefaults.FONT_SIZE;\r\n\r\n        /**\r\n         * the font family in which to render the text\r\n         * @type {string}\r\n         */\r\n        this.fontFamily = options.fontFamily || TextDefaults.fontFamily;\r\n\r\n        /**\r\n         * the font style with which to render the text\r\n         * @type {string}\r\n         */\r\n        this.fontStyle = options.fontStyle || TextDefaults.FONT_STYLE;\r\n\r\n        /**\r\n         * the font variant in which to render the text\r\n         * @type {string}\r\n         */\r\n        this.fontVariant = options.fontVariant || TextDefaults.FONT_VARIANT;\r\n\r\n        /**\r\n         * the font weight at which to render the text\r\n         * @type {string}\r\n         */\r\n        this.fontWeight = options.fontWeight || TextDefaults.FONT_WEIGHT;\r\n\r\n        /**\r\n         * the line height of the text\r\n         * @type {string}\r\n         */\r\n        this.lineHeight = options.lineHeight || TextDefaults.LINE_HEIGHT;\r\n\r\n        /**\r\n         * the alignment with which to render the text\r\n         * @type {string}\r\n         */\r\n        this.textAlign = options.textAlign || TextDefaults.TEXT_ALIGN;\r\n\r\n        /**\r\n         * the baseline for the text\r\n         * @type {string}\r\n         */\r\n        this.textBaseline = options.textBaseline || TextDefaults.TEXT_BASELINE;\r\n\r\n        /**\r\n         * lets textMetrics getter know if it needs to update its data\r\n         * @type {boolean}\r\n         */\r\n        this._textMetricsNeedUpdate = true;\r\n\r\n        /**\r\n         * a [TextMetrics](https://developer.mozilla.org/en-US/docs/Web/API/TextMetrics) object\r\n         * with additional height information\r\n         * @type {object}\r\n         */\r\n        this._textMetrics = null;\r\n\r\n        //TODO: write out this function for optimization\r\n        //this._updateTextMetrics(this.fontString);\r\n    }\r\n\r\n    /**\r\n     * get the longform representation\r\n     * @type {string}\r\n     */\r\n    get fontString() {\r\n        return TextUtils.formatFontString(this.fontStyle, this.fontVariant, this.fontWeight, this.fontSize, this.lineHeight, this.fontFamily);\r\n    }\r\n\r\n    /**\r\n     * compute the height data and add it to the textMetrics object from the canvas context\r\n     * @type {object}\r\n     */\r\n    get textMetrics() {\r\n        if (this._textMetricsNeedUpdate || this._textMetrics === null) {\r\n            this._updateStyle();\r\n            this._textMetrics = TextUtils.measureText(this.text, this._prerenderingContext, this.style);\r\n            Object.assign(this._textMetrics, TextUtils.getTextHeight(this.style.font));\r\n            this._textMetricsNeedUpdate = false;\r\n        }\r\n        return this._textMetrics;\r\n    }\r\n\r\n    /**\r\n     * get the bounding box of the text object\r\n     * @type {top: number, left: number, bottom: number, right: number}\r\n     */\r\n    get boundingBox() {\r\n        return {\r\n            top: this.offset.y - this.textMetrics.ascent,\r\n            left: this.offset.x,\r\n            bottom: this.offset.y + this.textMetrics.descent,\r\n            right: this.offset.x + this.textMetrics.width\r\n        };\r\n    }\r\n\r\n    /**\r\n     * update the style options for the text\r\n     * @param {object} options\r\n     */\r\n    _updateStyle(options) {\r\n        Object.assign(this.style, options, {\r\n            font: this.fontString,\r\n            textAlign: this.textAlign,\r\n            textBaseline: this.textBaseline\r\n        });\r\n    }\r\n\r\n\r\n    /**\r\n     * override the render function for text objects\r\n     * @override\r\n     */\r\n    render() {\r\n        this._textMetricsNeedUpdate = true;\r\n        this._updateStyle();\r\n        drawText(0, this.textMetrics.ascent, this.text, this._prerenderingContext, this.style);\r\n\r\n        /*if (this.flags.DEBUG) {\r\n            Renderer.drawPath(this._prerenderingContext, [{\r\n                x: 0,\r\n                y: this.textMetrics.ascent\r\n            }, {\r\n                x: this.textMetrics.width,\r\n                y: this.textMetrics.ascent\r\n            }], {\r\n                strokeStyle: 'Blue'\r\n            });\r\n            Renderer.drawCircle(this._prerenderingContext, 0, this.textMetrics.ascent, 3, {\r\n                strokeStyle: 'Blue',\r\n                fillStyle: 'Blue'\r\n            });\r\n        }*/\r\n    }\r\n}\r\n"],"file":"Text.js"}